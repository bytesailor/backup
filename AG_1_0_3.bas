10 DEFINTA-Y:COLOR15,1,1:SCREEN 2,3,0:OPEN"GRP:"AS#1:DIM I(29),J(29),D(29),TR(29):P=14:LS=0:V=2:SG=1:SC=0
20 A$=CHR$(&B11000011) : B$=CHR$(&B10000001) : SPRITE$(1) = A$ + B$ :SOUND 7,&B10111000
30 FOR M=0 TO 10:K(M)=8+M-(M>4)*12:NEXT
40 PSET (0,0),0:PRINT#1,"  TIME: 01234     SCORE: 56789"
45 OF=30 :SG=SC+1: GOSUB 620
50 SG=10:OF=13 : GOSUB 620
60 C=3 : L=3 : A=0 : W=0: IN = 0
70 FOR Y = 32 TO 152 STEP 30
80 FOR X = 50 TO 200 STEP 30
90 Z = RND(1)*4
100 PSET(X,Y),1 : PRINT#1,CHR$(205+Z)
110 I(A)=X : J(A)=Y
120 D(A)=Z : A=A+1
130 NEXT X: NEXT Y
140 ON INTERVAL=60 GOSUB 570
150 INTERVAL ON
160 S = STICK(0) : IF S=3 AND C<6 THEN CH=CH+30 : P=P+1 : C=C+1 ELSE IF S=7 AND C>1 THEN CH=CH-30 : P=P-1 : C=C-1 ELSE IF S=1 AND L>1 THEN CV=CV-30 : P=P-6 : L=L-1 ELSE IF S=5 AND L<5 THEN CV=CV+30 : P=P+6 : L=L+1 
165 'PSET(106+CH,86+CV):PRINT#1,P
170 TR(0)=P
180 PUTSPRITE1,(106+CH,86+CV),9
190 FOR B = 0 TO 30: NEXT B
200 IF STRIG(0) THEN TIME=0 : GOTO 230
210 'INTERVAL OFF
220 GOTO 160
230 'INÍCIO DA ROTINA/LOOP DE SEGUIR A TRAJETÓRIA T DO RAIO.
240 INTERVAL OFF
250 FOR A = 0 TO 18
260 'PRIMEIRO IF TRATA SETA PRA BAIXO / D = DIRECAO
270 IF D(P)=0 THEN GOTO 280 ELSE GOTO 310
280 IF L<5 THEN LINE (I(P),J(P))-(I(P),J(P)+30),11 : P=P+6 : L=L+1 : SC=SC+1 : GOTO 310
290 'APÓS O RAIO PRA FOR DO CAMPO, IR PRA ROTINA DE ERRO
300 LINE (I(P),J(P))-(I(P),J(P)+50),11 : GOSUB 540 : GOTO 510
310 'SEGUNDO IF: TRATA SETA PRA CIMA
320 IF D(P) = 1 THEN GOTO 330  ELSE GOTO 360
330 IF L>1 THEN LINE (I(P),J(P))-(I(P),J(P)-30),11 : P=P-6 : L=L-1: SC=SC+1 : GOTO 360
340 LINE (I(P),J(P))-(I(P),J(P)-50),11 : GOSUB 540 : GOTO 510
350 'TERCEIRO IF: TRATA SETA PRA DIREITA 
360 IF D(P)=2 THEN GOTO 370 ELSE GOTO 400
370 IF C<6 THEN LINE (I(P),J(P))-(I(P)+30,J(P)),11 : P=P+1 : C=C+1: SC=SC+1 :GOTO 400
380 LINE (I(P),J(P))-(I(P)+50,J(P)),11 : GOSUB 540 : GOTO 510
390 'QUARTO IF: TRATA SETA PRA ESQUERDA
400 IF D(P)=3 THEN GOTO 410 ELSE GOTO 430
410 IF C>1 THEN LINE (I(P),J(P))-(I(P)-30,J(P)),11 :P=P-1 : C=C-1: SC=SC+1 : GOTO 430
420 LINE (I(P),J(P))-(I(P)-50,J(P)),11 : GOSUB 540 :  GOTO 510
430 IN=IN+1 : TR(IN)=P  
440 FOR B=0 TO 19: B=A+1
450 'IF A>14 THEN v=2 ELSE IF TR(A)+1 = TR(B) THEN :IN=0 :GOTO 470: NEXT B 
455 IF TR(A) = TR(B) OR A>6 THEN : IN=0: GOTO 470::NEXT B
457 'IF TR(A)+1 = TR(B) THEN :IN=0 :GOTO 470: NEXT B 
458 'PSET(10+W,168):PRINT#1,TR(A)
460 'PSET(10+W,180):W=W+14:PRINT#1,A:NEXT A
465 NEXT A
470 'ROTINA DE CONTAGEM DE PONTOS
480 INTERVAL OFF: IF SC > LS+10 THEN PSET(65,168):PRINT#1,"BONUS SCORE!!","+";SC-LS: PLAY"L16cecece","EG"
490 LS = SC 
500 OF=30 : SG=SC+1: GOSUB 620 
510 PSET(10,185) : PRINT#1,"HIT SPACEBAR WHEN YOU'RE READY!"
520 IF STRIG(0) THEN CLS: CH=0 : CV=0 : P=14 : GOTO 20 ELSE GOTO 520 
530 'DATA 20,20,50,20,80,20,110,20,20,50,50,50,80,50,110,50,20,80,50,80,80,80,110,80,20,110,50,110,80,110,110,110
540 SOUND8,16:SOUND0,9:SOUND1,0:SOUND7,0:SOUND6,0:SOUND12,30:SOUND13,1: COLOR15,1,8 : V=V-1 : CLS : SCREEN3,3,0:PSET (45,35),0:PRINT#1,"OUCH!!":COLOR15,1,1:SCREEN2,3,0
550 IF V=0 THEN CLS : PSET (89,96),0 :PRINT#1,"GAME OVER":FOR W=0 TO 3000 : NEXT W: END : ELSE RETURN
560 'ROTINA DE CONTAGEM REGRESSIVA
570 IF SG<=7 THEN GOTO 580 ELSE GOTO 600
580 SOUND 8,15:SOUND 0,93:SOUND 1,0:FOR F=0 TO 20:NEXT F
590 SOUND 0,45:SOUND 1,0:FOR F=0 TO 29:NEXT F: SOUND 8,0
600 SG=SG-1 ': PSET(150,50),0 : PRINT#1,SG : RETURN
610 IF SG=1 THEN INTERVAL OFF: GOTO 540
620 T$="00"+STR$(SG-1)
630 FOR R=1 TO 5:VPOKE BASE(10)+OF-R,K(ASC(RIGHT$(T$,R))AND15):NEXT
640 RETURN
650 'TR(A)=P:IN=IN+1:PRINT#1,TR(A),IN:RETURN
